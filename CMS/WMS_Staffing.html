<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Roster Management</title>
  <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="../CMS/Javascript/CMS_General.js" defer></script>
<script src="../CMS/Javascript/CMS_Basic_Account.js" defer></script>
<link rel="stylesheet" href="../CMS/Css/CMS_Main.css">
<link rel="stylesheet" href="../CMS/Css/WMS_Main.css">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
</head>
<body>
	<div class="WMS_Cal_Container">
		<div class="WMS_Cal_Top CMS_DisFlex">
			<div class="WMS_Cal_TLeft CMS_DisBox">
				<h3>Monday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
				<h3>Tuesday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
				<h3>Wednesday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
				<h3>Thursday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
			</div>
			<div class="WMS_Cal_Center CMS_DisBox">
				<h3>Friday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
				<h3>Saterday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
				<h3>sunday</h3>
				<ul class="WMS_Roster_Active WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr"></ul>
			</div>
			<div class="WMS_Cal_TRight">
				<div class="WMS_Cal_Loc">
					<h2>Locations</h2>
					<select>
						<option value="">Select location</option>
						<option value="">Test location A</option>
						<option value="">Test location A</option>
						<option value="">Test location A</option>
					</select>
				</div>
				<div class="WMS_Cal_Cal">
					<h2>Calander</h2>
					<div class="CMS_Cal_Header CMS_DisFlex">
						<div class="CMS_DisBox CMS_FlNstr CMS_DisFlex CMS_AlCen"><button onclick="CMS_Cal_CM(-1)">←</button></div>
						<div class="CMS_DisBox CMS_TaCe"><h2 id="CMS_Mo_Ye"></h2></div>
						<div class="CMS_DisBox CMS_FlNstr CMS_DisFlex CMS_AlCen"><button onclick="CMS_Cal_CM(1)">→</button></div>
					</div>
					<div class="CMS_Cal_Week" id="CMS_Cal_Week"></div>
					<div class="CMS_Cal_Grid" id="CMS_Cal_Grid"></div>
				</div>
			</div>
		</div>
	
	<div class="WMS_Cal_Bot CMS_DisFlex">
		<div class="staff WMS_Cal_BLeft CMS_DisBox" id="WMS_Mo_AvSt">
			<h2>Available Staff</h2>
			<ul id="WMS_Dup_tar" class="WMS_Roster_Available WMS_Cal_Sort CMS_SL_N CMS_Cu_Gr">
				<li data-id="1"><div><div>Peter</div><div><select><option>Driver</option></select><button class="CMS_Dup">+</button></div></div></li>
				<li data-id="2"><div><div>Frank</div><div><select><option>Driver</option></select><button class="CMS_Dup">+</button></div></div></li>
				<li data-id="3"><div><div>Anita</div><div><select><option>Driver</option></select><button class="CMS_Dup">+</button></div></div></li>
				<li data-id="4"><div><div>Merel</div><div><select><option>Driver</option></select><button class="CMS_Dup">+</button></div></div></li>
			</ul>
		</div>
		<div class="staff WMS_Cal_BRight CMS_DisBox" id="unWMS_Mo_AvSt">
			<h2>[not implemented]Unavailable Staff</h2>
			<ul class="WMS_Roster_Unav CMS_SL_N">
				<li>Denis</li>
			</ul>
		</div>
	</div>
</div>

<script>

/* Calander */
const currentDate = new Date();

function CMS_Cal_Gen(date) {
	const year = date.getFullYear();	const month = date.getMonth();	const firstDay = new Date(year, month, 1);
	const lastDay = new Date(year, month + 1, 0);	const startDay = firstDay.getDay(); // 0 (Sun) to 6 (Sat)

	const $CMS_Cal_Grid = $('#CMS_Cal_Grid');	const $CMS_Mo_Ye = $('#CMS_Mo_Ye');	const $weekNumber = $('#weekNumber');
	const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
	$CMS_Cal_Grid.empty();

	$.each(daysOfWeek, function(_, day){	const $dayElem = $('<div>').addClass('CMS_Cal_Day').text(day);	$CMS_Cal_Grid.append($dayElem); });
	for(let i = 0; i < startDay; i++){ $CMS_Cal_Grid.append($('<div>'));}
	for(let d = 1; d <= lastDay.getDate(); d++){
		const fullDate = new Date(year, month, d);	const mysqlDate = fullDate.toISOString().split('T')[0];
		const $dateElem = $('<div>').addClass('CMS_Cal_Date').text(d).on('click', function(){	alert("Selected MySQL Date: " + mysqlDate); });
		$CMS_Cal_Grid.append($dateElem);
	}
	$CMS_Mo_Ye.text(firstDay.toLocaleString('default', { month: 'long' }) + ' ' + year);
	const weekNum = CMS_Cal_WeNr(firstDay);
	$weekNumber.text('Week ' + weekNum);
}

function CMS_Cal_CM(offset){currentDate.setMonth(currentDate.getMonth() + offset); CMS_Cal_Gen(currentDate); }
function CMS_Cal_WeNr(d){	d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));	d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));
	const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));		const weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7);	return weekNo;
}

$(document).ready(function(){
	CMS_Cal_Gen(currentDate);
	$(document).on('click','.CMS_Dup',function(){
		let $CMS_Dup1=$(this).parent().parent().parent().clone();
		let $CMS_Dup2=$('#WMS_Dup_tar');
		let CMS_Dup3=$CMS_Dup1.attr('data-id');
		if(!$CMS_Dup2.find(`[data-id="${CMS_Dup3}"]`).length){
			$CMS_Dup2.append($CMS_Dup1);
		}
	});
});

$(function () {
	$(".WMS_Cal_Sort").sortable({
		connectWith: ".WMS_Cal_Sort",
		placeholder: "WMS_So_Place"
	}).disableSelection();
});



  </script>
</body>
</html>